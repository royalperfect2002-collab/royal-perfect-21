<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Perfect - Premium Luxury E-Commerce</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #131921;
            --secondary: #232f3e;
            --gold: #d4af37;
            --gold-light: #c9a961;
            --text-primary: #fff;
            --text-secondary: #b0b0b0;
            --border: #404855;
            --success: #31a24c;
            --warning: #ff9500;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: var(--primary);
            color: var(--text-primary);
            line-height: 1.6;
        }
        .page { display: none; }
        .page.active { display: block; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.95); z-index: 2000; align-items: center; justify-content: center; padding: 20px; overflow-y: auto; }
        .modal.active { display: flex; }
        .modal-content { background: var(--secondary); border: 2px solid var(--gold); border-radius: 4px; padding: 25px; max-width: 700px; width: 100%; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid var(--border); padding-bottom: 15px; }
        .modal-header h2 { color: var(--gold); font-size: 20px; }
        .modal-close { background: none; border: none; color: var(--text-primary); font-size: 28px; cursor: pointer; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; color: var(--gold); margin-bottom: 6px; font-size: 13px; font-weight: 600; }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%; padding: 10px; background: var(--primary); border: 1px solid var(--border);
            color: var(--text-primary); border-radius: 3px; font-family: inherit; font-size: 13px;
        }
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            outline: none; border-color: var(--gold); box-shadow: 0 0 8px rgba(212, 175, 55, 0.3);
        }
        .btn-primary { background: var(--gold); color: #111; padding: 10px 20px; border: none; border-radius: 3px; font-weight: 700; cursor: pointer; font-size: 13px; width: 100%; transition: all 0.2s; }
        .btn-primary:hover { background: var(--gold-light); }
        .btn-secondary { background: var(--border); color: var(--text-primary); padding: 8px 16px; border: none; border-radius: 3px; font-weight: 700; cursor: pointer; font-size: 12px; margin-right: 8px; transition: all 0.2s; }
        .btn-secondary:hover { background: #555; }
        .btn-edit { background: #4CAF50; color: white; border: none; padding: 6px 12px; border-radius: 3px; cursor: pointer; font-size: 11px; font-weight: 700; }
        .btn-delete { background: #ff3333; color: white; border: none; padding: 6px 12px; border-radius: 3px; cursor: pointer; font-size: 11px; font-weight: 700; }
        .header-top { background: var(--primary); border-bottom: 1px solid var(--border); padding: 10px 20px; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 8px rgba(212, 175, 55, 0.2); }
        .header-top-content { max-width: 1500px; margin: 0 auto; display: flex; align-items: center; gap: 20px; justify-content: space-between; flex-wrap: wrap; }
        .logo-section { display: flex; align-items: center; gap: 10px; min-width: 200px; }
        .logo-img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--gold); object-fit: cover; }
        .logo-text { font-size: 20px; font-weight: 700; color: var(--gold); text-transform: uppercase; letter-spacing: 1px; }
        .search-container { flex: 1; display: flex; align-items: center; background: var(--text-primary); border-radius: 4px; height: 38px; max-width: 500px; min-width: 200px; }
        .search-container input { flex: 1; border: none; padding: 8px 12px; background: transparent; color: #111; font-size: 14px; }
        .search-container input::placeholder { color: #999; }
        .search-btn { background: var(--gold); border: none; color: #111; padding: 0 15px; cursor: pointer; height: 100%; border-radius: 0 4px 4px 0; font-weight: 700; }
        .header-right { display: flex; gap: 15px; align-items: center; min-width: 150px; justify-content: flex-end; }
        .header-link { color: var(--text-primary); text-decoration: none; font-size: 12px; padding: 5px 10px; cursor: pointer; transition: all 0.2s; }
        .header-link:hover { color: var(--gold); }
        .cart-icon { position: relative; cursor: pointer; font-size: 28px; transition: all 0.2s; }
        .cart-icon:hover { color: var(--gold); }
        .cart-badge { position: absolute; top: -10px; right: -5px; background: var(--warning); color: white; border-radius: 50%; width: 22px; height: 22px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700; }
        .navbar { background: var(--secondary); border-bottom: 1px solid var(--border); padding: 0; overflow-x: auto; }
        .navbar-content { max-width: 1500px; margin: 0 auto; display: flex; gap: 0; align-items: center; padding: 0 20px; }
        .nav-item { padding: 12px 15px; color: var(--text-primary); font-size: 13px; font-weight: 500; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.2s; white-space: nowrap; }
        .nav-item:hover { border-bottom-color: var(--gold); color: var(--gold); }
        .banner { background: linear-gradient(135deg, #000 0%, #1a1a1a 100%); padding: 50px 20px; text-align: center; border-bottom: 2px solid var(--gold); }
        .banner-content { max-width: 1500px; margin: 0 auto; }
        .banner h1 { font-size: 42px; color: var(--gold); margin-bottom: 10px; text-shadow: 0 2px 10px rgba(0,0,0,0.8); }
        .banner p { color: var(--text-secondary); font-size: 16px; }
        .social-links { display: flex; gap: 15px; justify-content: center; margin-top: 15px; }
        .social-link { display: inline-flex; align-items: center; justify-content: center; width: 40px; height: 40px; background: var(--gold); border-radius: 50%; color: #111; text-decoration: none; font-size: 20px; transition: all 0.3s; }
        .social-link:hover { transform: scale(1.15); background: var(--gold-light); }
        .main-container { max-width: 1500px; margin: 0 auto; padding: 20px; display: grid; grid-template-columns: 250px 1fr; gap: 20px; }
        .sidebar { background: var(--secondary); border: 1px solid var(--border); border-radius: 4px; padding: 15px; height: fit-content; position: sticky; top: 100px; }
        .sidebar h3 { color: var(--gold); font-size: 14px; margin-bottom: 12px; font-weight: 700; text-transform: uppercase; border-bottom: 1px solid var(--border); padding-bottom: 10px; }
        .filter-group { margin-bottom: 20px; }
        .filter-group-title { color: var(--gold); font-size: 12px; margin-bottom: 10px; font-weight: 700; text-transform: uppercase; }
        .filter-option { display: flex; align-items: center; gap: 8px; margin-bottom: 10px; font-size: 12px; cursor: pointer; color: var(--text-secondary); }
        .filter-option input[type="checkbox"] { cursor: pointer; width: 16px; height: 16px; accent-color: var(--gold); }
        .filter-option label { cursor: pointer; }
        .products-section { background: var(--secondary); border: 1px solid var(--border); border-radius: 4px; padding: 20px; }
        .section-title { color: var(--gold); font-size: 16px; margin-bottom: 15px; font-weight: 700; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 12px; }
        .product-item { background: var(--primary); border: 1px solid var(--border); border-radius: 4px; overflow: hidden; transition: all 0.3s; display: flex; flex-direction: column; cursor: pointer; }
        .product-item:hover { border-color: var(--gold); box-shadow: 0 0 15px rgba(212, 175, 55, 0.3); transform: translateY(-5px); }
        .product-image { width: 100%; height: 150px; background-size: cover; background-position: center; background-color: #333; }
        .product-body { padding: 12px; flex: 1; display: flex; flex-direction: column; }
        .product-name { font-size: 12px; color: var(--text-primary); margin-bottom: 6px; line-height: 1.3; }
        .product-rating { font-size: 11px; color: var(--warning); margin-bottom: 8px; }
        .product-price { font-size: 16px; font-weight: 700; color: var(--gold); margin-bottom: 8px; }
        .product-buttons { display: flex; gap: 6px; margin-top: auto; }
        .btn-add-cart { flex: 1; background: var(--gold); color: #111; border: none; padding: 6px; border-radius: 3px; font-size: 11px; font-weight: 700; cursor: pointer; transition: all 0.2s; }
        .btn-add-cart:hover { background: var(--gold-light); }
        .btn-view-detail { flex: 1; background: var(--border); color: var(--text-primary); border: none; padding: 6px; border-radius: 3px; font-size: 11px; font-weight: 700; cursor: pointer; transition: all 0.2s; }
        .btn-view-detail:hover { background: #555; }
        .product-detail-page { background: var(--primary); min-height: 100vh; }
        .detail-header { background: var(--secondary); padding: 15px 20px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 15px; position: sticky; top: 0; z-index: 500; }
        .back-btn { background: var(--gold); color: #111; border: none; padding: 8px 15px; border-radius: 3px; cursor: pointer; font-weight: 700; transition: all 0.2s; }
        .back-btn:hover { background: var(--gold-light); }
        .detail-container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .detail-content { background: var(--secondary); border: 1px solid var(--border); border-radius: 4px; padding: 25px; margin-bottom: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .detail-image { width: 100%; height: 400px; background-size: cover; background-position: center; border-radius: 8px; border: 2px solid var(--border); }
        .detail-info h1 { font-size: 28px; color: var(--gold); margin-bottom: 15px; }
        .detail-rating { display: flex; gap: 10px; margin-bottom: 15px; align-items: center; }
        .stars { font-size: 16px; color: var(--warning); }
        .review-count { color: var(--text-secondary); font-size: 13px; }
        .detail-price { font-size: 32px; font-weight: 700; color: var(--gold); margin-bottom: 20px; border-bottom: 2px solid var(--border); padding-bottom: 15px; }
        .detail-desc { color: var(--text-secondary); line-height: 1.8; margin-bottom: 20px; }
        .detail-category { background: var(--primary); padding: 10px 15px; border-radius: 3px; margin-bottom: 20px; font-size: 12px; color: var(--text-secondary); }
        .detail-actions { display: flex; gap: 10px; margin-bottom: 20px; }
        .btn-primary-action { background: var(--gold); color: #111; border: none; padding: 12px 25px; border-radius: 3px; font-weight: 700; cursor: pointer; font-size: 14px; transition: all 0.2s; flex: 1; }
        .btn-primary-action:hover { background: var(--gold-light); }
        .btn-secondary-action { background: var(--warning); color: white; border: none; padding: 12px 25px; border-radius: 3px; font-weight: 700; cursor: pointer; font-size: 14px; transition: all 0.2s; flex: 1; }
        .btn-secondary-action:hover { background: #ff7d00; }
        .reviews-section { background: var(--secondary); border: 1px solid var(--border); border-radius: 4px; padding: 25px; margin-bottom: 30px; }
        .reviews-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid var(--border); padding-bottom: 15px; }
        .reviews-header h2 { color: var(--gold); font-size: 20px; }
        .rating-summary { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px; }
        .rating-box { background: var(--primary); padding: 15px; border-radius: 4px; text-align: center; }
        .rating-score { font-size: 36px; font-weight: 700; color: var(--gold); margin-bottom: 5px; }
        .rating-stars { font-size: 16px; color: var(--warning); margin-bottom: 5px; }
        .rating-label { font-size: 12px; color: var(--text-secondary); }
        .add-review-form { background: var(--primary); padding: 15px; border-radius: 4px; margin-bottom: 20px; border: 1px solid var(--border); }
        .add-review-form h3 { color: var(--gold); font-size: 14px; margin-bottom: 12px; }
        .review-item { background: var(--primary); border: 1px solid var(--border); border-radius: 4px; padding: 15px; margin-bottom: 12px; }
        .review-header { display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center; }
        .reviewer-name { color: var(--gold); font-weight: 700; font-size: 13px; }
        .review-date { color: var(--text-secondary); font-size: 11px; }
        .review-stars { color: var(--warning); font-size: 12px; margin-bottom: 8px; }
        .review-text { color: var(--text-secondary); font-size: 13px; line-height: 1.6; }
        .footer { background: var(--primary); border-top: 1px solid var(--border); padding: 40px 20px; margin-top: 40px; }
        .footer-content { max-width: 1500px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .footer-col h4 { color: var(--gold); font-size: 13px; margin-bottom: 10px; font-weight: 700; }
        .footer-col ul { list-style: none; }
        .footer-col li { margin-bottom: 6px; }
        .footer-col a { color: var(--text-secondary); text-decoration: none; font-size: 12px; }
        .footer-bottom { border-top: 1px solid var(--border); padding-top: 20px; text-align: center; color: var(--text-secondary); font-size: 12px; }
        .admin-btn { position: fixed; bottom: 25px; right: 25px; width: 50px; height: 50px; border-radius: 50%; background: var(--gold); color: #111; border: none; cursor: pointer; font-size: 22px; font-weight: 700; z-index: 999; box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4); transition: all 0.3s; }
        .admin-btn:hover { transform: scale(1.1); box-shadow: 0 6px 16px rgba(212, 175, 55, 0.6); }
        .tabs { display: flex; gap: 0; border-bottom: 2px solid var(--border); margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 12px; background: var(--primary); border: none; color: var(--text-secondary); cursor: pointer; font-weight: 600; transition: all 0.2s; border-bottom: 3px solid transparent; }
        .tab-btn.active { color: var(--gold); border-bottom-color: var(--gold); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .image-preview { width: 100%; height: 150px; background-size: cover; background-position: center; border: 2px dashed var(--gold); border-radius: 4px; margin-top: 10px; display: none; margin-bottom: 10px; }
        .image-preview.show { display: block; }
        .notification { position: fixed; top: 20px; right: 20px; background: var(--gold); color: #111; padding: 12px 20px; border-radius: 3px; z-index: 3000; font-weight: 700; font-size: 13px; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateX(400px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .admin-product-item { background: var(--primary); padding: 15px; margin-bottom: 12px; border-radius: 3px; border: 1px solid var(--border); display: flex; gap: 15px; align-items: flex-start; }
        .admin-product-image { width: 80px; height: 80px; background-size: cover; background-position: center; border-radius: 3px; border: 1px solid var(--gold); flex-shrink: 0; }
        .admin-product-info { flex: 1; }
        .admin-product-name { color: var(--gold); font-weight: 700; font-size: 14px; margin-bottom: 4px; }
        .admin-product-details { font-size: 12px; color: var(--text-secondary); margin-bottom: 8px; }
        .admin-product-buttons { display: flex; gap: 8px; flex-wrap: wrap; }
        .cart-item { display: flex; gap: 10px; align-items: center; padding: 12px; background: var(--primary); border: 1px solid var(--border); border-radius: 3px; margin-bottom: 10px; }
        .cart-item-image { width: 60px; height: 60px; background-size: cover; background-position: center; border-radius: 3px; flex-shrink: 0; }
        .cart-item-details { flex: 1; }
        .cart-item-name { color: var(--gold); font-weight: 700; font-size: 13px; }
        .cart-item-qty { color: var(--text-secondary); font-size: 12px; }
        .cart-item-price { color: var(--gold); font-weight: 700; }
        .qty-btn { background: var(--gold); color: #111; border: none; width: 24px; height: 24px; border-radius: 3px; cursor: pointer; font-weight: 700; }
        .qty-input { width: 35px; background: var(--primary); border: 1px solid var(--border); color: var(--text-primary); text-align: center; border-radius: 3px; padding: 4px; }
        .cart-summary { background: var(--primary); padding: 15px; border-radius: 3px; border: 1px solid var(--border); margin-bottom: 15px; }
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .summary-row.total { font-size: 16px; font-weight: 700; color: var(--gold); border-top: 2px solid var(--border); padding-top: 10px; margin-top: 10px; }
        .cart-empty-msg { color: var(--text-secondary); text-align: center; padding: 30px; }
        .btn-place-order { background: var(--warning) !important; color: white !important; }
        .btn-place-order:hover { background: #ff7d00 !important; }
        @media (max-width: 1024px) {
            .main-container { grid-template-columns: 1fr; }
            .sidebar { display: none; }
            .products-grid { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
            .detail-content { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) {
            .header-top-content { flex-wrap: wrap; }
            .search-container { order: 3; flex-basis: 100%; margin-top: 10px; }
            .products-grid { grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); }
            .banner h1 { font-size: 28px; }
            .social-links { gap: 10px; }
            .social-link { width: 35px; height: 35px; font-size: 16px; }
            .modal-content { max-width: 95%; }
            .cart-item { flex-direction: column; }
            .rating-summary { grid-template-columns: 1fr; }
        }
        @media (max-width: 480px) {
            .products-grid { grid-template-columns: 1fr; }
            .nav-item { padding: 10px 12px; font-size: 12px; }
            .main-container { padding: 10px; }
        }
    </style>
</head>
<body>

<!-- HOME PAGE -->
<div id="homePage" class="page active">
    <div class="header-top">
        <div class="header-top-content">
            <div class="logo-section">
                <img src="https://agi-prod-file-upload-public-main-use1.s3.amazonaws.com/4c5bf2f5-163f-4de2-9a92-2957ec6ecf83" alt="Royal Perfect" class="logo-img">
                <div class="logo-text">Royal Perfect</div>
            </div>
            <div class="search-container">
                <input type="text" id="searchBox" placeholder="Search jewelry, sarees, dresses..." onkeyup="searchProducts()">
                <button class="search-btn" onclick="searchProducts()">Search</button>
            </div>
            <div class="header-right">
                <div class="header-link" onclick="openAdminModal()">‚öôÔ∏è Admin</div>
                <div class="cart-icon" onclick="openCart()">üõí<span class="cart-badge" id="cartBadge">0</span></div>
            </div>
        </div>
    </div>

    <div class="navbar">
        <div class="navbar-content">
            <div class="nav-item" onclick="filterByCategory('all')">All</div>
            <div class="nav-item" onclick="filterByCategory('jewelry')">üíé Jewelry</div>
            <div class="nav-item" onclick="filterByCategory('sarees')">üëó Sarees</div>
            <div class="nav-item" onclick="filterByCategory('dresses')">üë† Dresses</div>
            <div class="nav-item" onclick="filterByCategory('accessories')">‚ú® Accessories</div>
        </div>
    </div>

    <div class="banner">
        <div class="banner-content">
            <h1>‚ú® Royal Perfect Premium Luxury ‚ú®</h1>
            <p>Authentic Jewelry ‚Ä¢ Designer Sarees ‚Ä¢ Elegant Dresses ‚Ä¢ Premium Accessories</p>
            <div class="social-links">
                <a id="instaLink" class="social-link" target="_blank" title="Instagram">üì∑</a>
                <a id="youtubeLink" class="social-link" target="_blank" title="YouTube">‚ñ∂Ô∏è</a>
            </div>
        </div>
    </div>

    <div class="main-container">
        <div class="sidebar">
            <h3>üîç Filters</h3>
            <div class="filter-group">
                <div class="filter-group-title">Price Range</div>
                <div class="filter-option"><input type="checkbox" id="price1" onchange="applyFilters()"><label for="price1">Under ‚Çπ2,000</label></div>
                <div class="filter-option"><input type="checkbox" id="price2" onchange="applyFilters()"><label for="price2">‚Çπ2,000 - ‚Çπ5,000</label></div>
                <div class="filter-option"><input type="checkbox" id="price3" onchange="applyFilters()"><label for="price3">‚Çπ5,000 - ‚Çπ10,000</label></div>
                <div class="filter-option"><input type="checkbox" id="price4" onchange="applyFilters()"><label for="price4">Above ‚Çπ10,000</label></div>
            </div>
            <button class="btn-primary" onclick="clearFilters()" style="width: 100%; margin-top: 15px;">Clear Filters</button>
        </div>
        <div>
            <div class="products-section">
                <h2 class="section-title">Featured Products</h2>
                <div class="products-grid" id="productsGrid"></div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="footer-content">
            <div class="footer-col">
                <h4>Contact Info</h4>
                <ul>
                    <li>üì± WhatsApp: 8220390911</li>
                    <li>üìß Email: royalperfect2002@gmail.com</li>
                    <li>üìç Chennai, India</li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Policies</a></li>
                    <li><a href="#">FAQs</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">¬© 2025 Royal Perfect. All Rights Reserved.</div>
    </div>
</div>

<!-- PRODUCT DETAIL PAGE WITH REVIEWS -->
<div id="productDetailPage" class="page product-detail-page">
    <div class="detail-header">
        <button class="back-btn" onclick="goHome()">‚Üê Back</button>
        <h2 id="detailTitle" style="flex: 1; color: var(--gold); margin: 0;"></h2>
    </div>

    <div class="detail-container">
        <div class="detail-content">
            <div id="detailImage" style="width: 100%; height: 400px; background-size: cover; background-position: center; border-radius: 8px; border: 2px solid var(--border);"></div>
            <div>
                <h1 id="detailName"></h1>
                <div class="detail-rating">
                    <span class="stars" id="detailStars"></span>
                    <span class="review-count" id="detailReviewCount"></span>
                </div>
                <div class="detail-price" id="detailPrice"></div>
                <div class="detail-category" id="detailCategory"></div>
                <div class="detail-desc" id="detailDesc"></div>
                <div class="detail-actions">
                    <button class="btn-primary-action" onclick="addToCart(currentProduct.id)">üõí Add to Cart</button>
                    <button class="btn-secondary-action" onclick="buyNow(currentProduct.id)">üí≥ Buy Now</button>
                </div>
            </div>
        </div>

        <div class="reviews-section">
            <div class="reviews-header">
                <h2>‚≠ê Customer Reviews & Ratings</h2>
            </div>

            <div class="rating-summary">
                <div class="rating-box">
                    <div style="color: var(--text-secondary); margin-bottom: 10px;">Average Rating</div>
                    <div class="rating-score" id="avgRating">5.0</div>
                    <div class="rating-stars" id="summaryStars"></div>
                </div>
                <div class="rating-box">
                    <div style="color: var(--text-secondary); margin-bottom: 10px;">Total Reviews</div>
                    <div class="rating-score" id="totalReviewCount">0</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">customer reviews</div>
                </div>
            </div>

            <div class="add-review-form">
                <h3>‚úçÔ∏è Add Your Review</h3>
                <div class="form-group">
                    <label>Your Name</label>
                    <input type="text" id="reviewName" placeholder="Enter your name">
                </div>
                <div class="form-group">
                    <label>Rating</label>
                    <select id="reviewRating">
                        <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent (5)</option>
                        <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Good (4)</option>
                        <option value="3">‚≠ê‚≠ê‚≠ê Average (3)</option>
                        <option value="2">‚≠ê‚≠ê Poor (2)</option>
                        <option value="1">‚≠ê Very Poor (1)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Your Review</label>
                    <textarea id="reviewText" placeholder="Share your experience..." style="min-height: 100px;"></textarea>
                </div>
                <button class="btn-primary" onclick="submitReview()">Post Review</button>
            </div>

            <h3 style="color: var(--gold); margin: 20px 0 15px 0;">All Reviews</h3>
            <div id="reviewsList"></div>
        </div>
    </div>
</div>

<!-- CART MODAL -->
<div id="cartModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>üõí Shopping Cart</h2>
            <button class="modal-close" onclick="closeCart()">‚úï</button>
        </div>

        <div id="cartItemsContainer" style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;"></div>

        <div class="cart-summary">
            <div class="summary-row">
                <span>Subtotal:</span>
                <span id="subtotalPrice">‚Çπ0</span>
            </div>
            <div class="summary-row">
                <span>Shipping:</span>
                <span>FREE</span>
            </div>
            <div class="summary-row total">
                <span>Total Amount:</span>
                <span id="totalPrice">‚Çπ0</span>
            </div>
        </div>

        <div style="display: flex; gap: 10px;">
            <button class="btn-primary" onclick="closeCart()" style="flex: 1;">Continue Shopping</button>
            <button class="btn-primary btn-place-order" onclick="openOrderForm()" style="flex: 1;">Place Order</button>
        </div>
    </div>
</div>

<!-- ORDER FORM MODAL -->
<div id="orderModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>üìã Order Details</h2>
            <button class="modal-close" onclick="closeOrderForm()">‚úï</button>
        </div>

        <div class="form-group">
            <label>üë§ Full Name *</label>
            <input type="text" id="orderName" placeholder="Enter your full name">
        </div>
        <div class="form-group">
            <label>üì± Mobile Number *</label>
            <input type="tel" id="orderMobile" placeholder="10-digit mobile number" maxlength="10" oninput="this.value=this.value.replace(/[^0-9]/g,'')">
        </div>
        <div class="form-group">
            <label>üìß Email</label>
            <input type="email" id="orderEmail" placeholder="your@email.com">
        </div>
        <div class="form-group">
            <label>üìç Full Address *</label>
            <textarea id="orderAddress" placeholder="Enter your complete address" style="min-height:80px;"></textarea>
        </div>
        <div class="form-group" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div>
                <label>üèôÔ∏è City *</label>
                <input type="text" id="orderCity" placeholder="City">
            </div>
            <div>
                <label>üìÆ Pincode *</label>
                <input type="text" id="orderPincode" placeholder="Pincode" oninput="this.value=this.value.replace(/[^0-9]/g,'')">
            </div>
        </div>
        <div class="form-group" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div>
                <label>üåç State *</label>
                <input type="text" id="orderState" placeholder="State">
            </div>
            <div>
                <label>üáÆüá≥ Country</label>
                <input type="text" id="orderCountry" placeholder="Country" value="India">
            </div>
        </div>

        <button class="btn-primary btn-place-order" onclick="submitOrder()" style="margin-bottom: 10px;">üì§ Send Order via WhatsApp</button>
        <button class="btn-secondary" onclick="closeOrderForm()" style="width: 100%;">Cancel</button>
    </div>
</div>

<!-- ADMIN MODAL -->
<div id="adminModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>‚öôÔ∏è Admin Panel</h2>
            <button class="modal-close" onclick="closeAdminModal()">‚úï</button>
        </div>

        <div id="adminPasswordSection">
            <div class="form-group">
                <label>üîê Admin Password</label>
                <input type="password" id="adminPass" placeholder="Enter password" onkeypress="if(event.key==='Enter') verifyAdmin()">
            </div>
            <button class="btn-primary" onclick="verifyAdmin()">Access Admin Panel</button>
        </div>

        <div id="adminContent" style="display: none;">
            <div class="tabs">
                <button class="tab-btn active" onclick="switchAdminTab('settings')">üì± Settings</button>
                <button class="tab-btn" onclick="switchAdminTab('products')">üì¶ Products</button>
                <button class="tab-btn" onclick="switchAdminTab('reviews')">‚≠ê Reviews</button>
            </div>

            <!-- SETTINGS TAB -->
            <div id="settingsTab" class="tab-content active">
                <h3 style="color: var(--gold); margin: 20px 0 15px 0;">üì± Social Media Links</h3>
                <div class="form-group">
                    <label>üì∑ Instagram Profile URL</label>
                    <input type="text" id="instaUrl" placeholder="https://instagram.com/yourprofile">
                </div>
                <div class="form-group">
                    <label>‚ñ∂Ô∏è YouTube Channel URL</label>
                    <input type="text" id="youtubeUrl" placeholder="https://youtube.com/yourchannel">
                </div>
                <button class="btn-primary" onclick="saveSocialLinks()">üíæ Save Social Links</button>
            </div>

            <!-- PRODUCTS TAB -->
            <div id="productsTab" class="tab-content">
                <h3 style="color: var(--gold); margin: 20px 0 15px 0;">üì¶ Add New Product</h3>
                <div class="form-group">
                    <label>Product Name *</label>
                    <input type="text" id="newProdName" placeholder="Product name">
                </div>
                <div class="form-group">
                    <label>Price (‚Çπ) *</label>
                    <input type="number" id="newProdPrice" placeholder="Price" min="0">
                </div>
                <div class="form-group">
                    <label>Category *</label>
                    <select id="newProdCategory">
                        <option value="jewelry">üíé Jewelry</option>
                        <option value="sarees">üëó Sarees</option>
                        <option value="dresses">üë† Dresses</option>
                        <option value="accessories">‚ú® Accessories</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="newProdDesc" placeholder="Product description"></textarea>
                </div>
                <div class="form-group">
                    <label>Upload Product Image *</label>
                    <input type="file" id="newProdImage" accept="image/*" onchange="previewNewImage(this)">
                    <div class="image-preview" id="newImagePreview"></div>
                </div>
                <button class="btn-primary" onclick="addProduct()">‚úÖ Add Product</button>

                <h3 style="color: var(--gold); margin: 30px 0 15px 0;">üìä Current Products</h3>
                <div id="adminProductsList" style="max-height: 600px; overflow-y: auto;"></div>
            </div>

            <!-- REVIEWS TAB -->
            <div id="reviewsTab" class="tab-content">
                <h3 style="color: var(--gold); margin: 20px 0 15px 0;">All Customer Reviews</h3>
                <div id="adminReviewsList" style="max-height: 500px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>
</div>

<!-- EDIT PRODUCT MODAL -->
<div id="editProductModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>‚úèÔ∏è Edit Product</h2>
            <button class="modal-close" onclick="closeEditModal()">‚úï</button>
        </div>

        <div class="form-group">
            <label>Product Name *</label>
            <input type="text" id="editProdName" placeholder="Product name">
        </div>
        <div class="form-group">
            <label>Price (‚Çπ) *</label>
            <input type="number" id="editProdPrice" placeholder="Price" min="0">
        </div>
        <div class="form-group">
            <label>Category *</label>
            <select id="editProdCategory">
                <option value="jewelry">üíé Jewelry</option>
                <option value="sarees">üëó Sarees</option>
                <option value="dresses">üë† Dresses</option>
                <option value="accessories">‚ú® Accessories</option>
            </select>
        </div>
        <div class="form-group">
            <label>Description</label>
            <textarea id="editProdDesc" placeholder="Product description"></textarea>
        </div>
        <div class="form-group">
            <label>Change Product Image</label>
            <input type="file" id="editProdImage" accept="image/*" onchange="previewEditImage(this)">
            <div class="image-preview" id="editImagePreview"></div>
        </div>
        <div style="display: flex; gap: 10px;">
            <button class="btn-primary" onclick="saveEditProduct()">üíæ Save Changes</button>
            <button class="btn-secondary" onclick="closeEditModal()" style="flex: 1;">Cancel</button>
        </div>
    </div>
</div>

<button class="admin-btn" onclick="openAdminModal()" title="Admin Panel">‚öôÔ∏è</button>

<script>
    const DB_NAME = 'RoyalPerfect';
    const PRODUCTS_STORE = 'products';
    const REVIEWS_STORE = 'reviews';
    const SETTINGS_STORE = 'settings';
    let db = null;
    let products = [];
    let allReviews = [];
    let cart = [];
    let currentProduct = null;
    let editingProductId = null;
    const adminPassword = "prakashrosy21";

    function initDB() {
        return new Promise((resolve, reject) => {
            const request = indexedDB.open(DB_NAME, 2);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => { db = request.result; resolve(db); };
            request.onupgradeneeded = (e) => {
                db = e.target.result;
                if (!db.objectStoreNames.contains(PRODUCTS_STORE)) db.createObjectStore(PRODUCTS_STORE, { keyPath: 'id' });
                if (!db.objectStoreNames.contains(REVIEWS_STORE)) db.createObjectStore(REVIEWS_STORE, { keyPath: 'id', autoIncrement: true });
                if (!db.objectStoreNames.contains(SETTINGS_STORE)) db.createObjectStore(SETTINGS_STORE, { keyPath: 'key' });
            };
        });
    }

    function saveToStore(storeName, data) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([storeName], 'readwrite');
            const store = transaction.objectStore(storeName);
            const request = store.put(data);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve(request.result);
        });
    }

    function getFromStore(storeName, key) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([storeName], 'readonly');
            const store = transaction.objectStore(storeName);
            const request = store.get(key);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve(request.result);
        });
    }

    function getAllFromStore(storeName) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([storeName], 'readonly');
            const store = transaction.objectStore(storeName);
            const request = store.getAll();
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve(request.result);
        });
    }

    function deleteFromStore(storeName, key) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([storeName], 'readwrite');
            const store = transaction.objectStore(storeName);
            const request = store.delete(key);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve();
        });
    }

    function convertImageToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    let width = img.width;
                    let height = img.height;
                    if (width > 500) {
                        height = (height * 500) / width;
                        width = 500;
                    }
                    canvas.width = width;
                    canvas.height = height;
                    canvas.getContext('2d').drawImage(img, 0, 0, width, height);
                    resolve(canvas.toDataURL('image/jpeg', 0.8));
                };
                img.src = reader.result;
            };
            reader.onerror = reject;
            reader.readAsDataURL(file);
        });
    }

    function previewNewImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('newImagePreview').style.backgroundImage = `url('${e.target.result}')`;
                document.getElementById('newImagePreview').classList.add('show');
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function previewEditImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('editImagePreview').style.backgroundImage = `url('${e.target.result}')`;
                document.getElementById('editImagePreview').classList.add('show');
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    async function loadSocialLinks() {
        try {
            const insta = await getFromStore(SETTINGS_STORE, 'instagram');
            const youtube = await getFromStore(SETTINGS_STORE, 'youtube');
            
            if (insta && insta.value) document.getElementById('instaLink').href = insta.value;
            if (youtube && youtube.value) document.getElementById('youtubeLink').href = youtube.value;
        } catch (err) { console.error('Error loading social links:', err); }
    }

    async function saveSocialLinks() {
        const instaUrl = document.getElementById('instaUrl').value.trim();
        const youtubeUrl = document.getElementById('youtubeUrl').value.trim();

        if (!instaUrl && !youtubeUrl) { showNotif('‚úó Enter at least one social link!'); return; }

        try {
            if (instaUrl) await saveToStore(SETTINGS_STORE, { key: 'instagram', value: instaUrl });
            if (youtubeUrl) await saveToStore(SETTINGS_STORE, { key: 'youtube', value: youtubeUrl });
            
            await loadSocialLinks();
            showNotif('‚úì Social links saved!');
        } catch (err) { showNotif('‚úó Error saving links!'); }
    }

    async function loadProducts() {
        try {
            products = await getAllFromStore(PRODUCTS_STORE);
            if (products.length === 0) {
                const defaultProducts = [
                    { id: 1, name: "Diamond Pendant", price: 4999, category: "jewelry", image: "https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=400&fit=crop", desc: "Premium diamond pendant with 18K gold setting" },
                    { id: 2, name: "Pearl Choker", price: 2999, category: "jewelry", image: "https://images.unsplash.com/photo-1573408301185-9146fe634ad0?w=400&h=400&fit=crop", desc: "Elegant pearl choker necklace" },
                    { id: 3, name: "Gold Earrings", price: 1499, category: "jewelry", image: "https://images.unsplash.com/photo-1509941943102-8c5a6b5e2e1e?w=400&h=400&fit=crop", desc: "Beautiful gold earrings" },
                    { id: 4, name: "Bridal Saree", price: 9999, category: "sarees", image: "https://images.unsplash.com/photo-1505252585461-04db1267ae5e?w=400&h=400&fit=crop", desc: "Luxurious bridal saree" },
                    { id: 5, name: "Evening Gown", price: 5999, category: "dresses", image: "https://images.unsplash.com/photo-1566073771259-6a8506099945?w=400&h=400&fit=crop", desc: "Stunning evening gown" },
                    { id: 6, name: "Luxury Tiara", price: 7999, category: "accessories", image: "https://images.unsplash.com/photo-1535632066927-ab7c9ab60908?w=400&h=400&fit=crop", desc: "Elegant luxury tiara" }
                ];
                for (let prod of defaultProducts) await saveToStore(PRODUCTS_STORE, prod);
                products = defaultProducts;
            }
            renderProducts(products);
            await loadAllReviews();
        } catch (err) { console.error('Error loading products:', err); }
    }

    function renderProducts(productsToRender = products) {
        const grid = document.getElementById('productsGrid');
        grid.innerHTML = productsToRender.map(p => {
            const avgRating = calculateProductRating(p.id);
            return `
                <div class="product-item">
                    <div class="product-image" style="background-image: url('${p.image}')"></div>
                    <div class="product-body">
                        <div class="product-name">${p.name}</div>
                        <div class="product-rating">${'‚≠ê'.repeat(Math.round(avgRating))}</div>
                        <div class="product-price">‚Çπ${p.price}</div>
                        <div class="product-buttons">
                            <button class="btn-add-cart" onclick="addToCart(${p.id})">Add Cart</button>
                            <button class="btn-view-detail" onclick="viewProductDetail(${p.id})">View</button>
                        </div>
                    </div>
                </div>
            `;
        }).join('');
    }

    function calculateProductRating(productId) {
        const productReviews = allReviews.filter(r => r.productId === productId);
        if (productReviews.length === 0) return 5;
        return (productReviews.reduce((sum, r) => sum + r.rating, 0) / productReviews.length);
    }

    async function viewProductDetail(productId) {
        currentProduct = products.find(p => p.id === productId);
        if (!currentProduct) return;

        document.getElementById('detailImage').style.backgroundImage = `url('${currentProduct.image}')`;
        document.getElementById('detailName').textContent = currentProduct.name;
        document.getElementById('detailPrice').textContent = `‚Çπ${currentProduct.price}`;
        document.getElementById('detailTitle').textContent = currentProduct.name;
        document.getElementById('detailCategory').textContent = `Category: ${currentProduct.category.toUpperCase()}`;
        document.getElementById('detailDesc').textContent = currentProduct.desc;

        await loadProductReviews(productId);
        showPage('productDetailPage');
        document.getElementById('reviewName').value = '';
        document.getElementById('reviewRating').value = '5';
        document.getElementById('reviewText').value = '';
    }

    async function loadAllReviews() {
        try {
            allReviews = await getAllFromStore(REVIEWS_STORE);
        } catch (err) { console.error('Error loading reviews:', err); }
    }

    async function loadProductReviews(productId) {
        const productReviews = allReviews.filter(r => r.productId === productId);
        
        if (productReviews.length === 0) {
            document.getElementById('avgRating').textContent = '5.0';
            document.getElementById('summaryStars').textContent = '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê';
            document.getElementById('totalReviewCount').textContent = '0';
            document.getElementById('reviewsList').innerHTML = '<p style="color: var(--text-secondary); text-align: center;">No reviews yet. Be the first!</p>';
            document.getElementById('detailStars').textContent = '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê';
            document.getElementById('detailReviewCount').textContent = '(0 reviews)';
            return;
        }

        const avgRating = (productReviews.reduce((sum, r) => sum + r.rating, 0) / productReviews.length).toFixed(1);
        document.getElementById('avgRating').textContent = avgRating;
        document.getElementById('summaryStars').textContent = '‚≠ê'.repeat(Math.round(avgRating));
        document.getElementById('totalReviewCount').textContent = productReviews.length;
        document.getElementById('detailStars').textContent = '‚≠ê'.repeat(Math.round(avgRating));
        document.getElementById('detailReviewCount').textContent = `(${productReviews.length} reviews)`;

        document.getElementById('reviewsList').innerHTML = productReviews.map(review => `
            <div class="review-item">
                <div class="review-header">
                    <span class="reviewer-name">${review.name}</span>
                    <span class="review-date">${new Date(review.date).toLocaleDateString()}</span>
                </div>
                <div class="review-stars">${'‚≠ê'.repeat(review.rating)}</div>
                <div class="review-text">"${review.text}"</div>
            </div>
        `).join('');
    }

    async function submitReview() {
        const name = document.getElementById('reviewName').value.trim();
        const rating = parseInt(document.getElementById('reviewRating').value);
        const text = document.getElementById('reviewText').value.trim();

        if (!name || !text) { showNotif('‚úó Fill name and review!'); return; }
        if (text.length < 10) { showNotif('‚úó Review must be at least 10 characters!'); return; }

        try {
            const review = {
                productId: currentProduct.id,
                name,
                rating,
                text,
                date: new Date().toISOString()
            };

            await saveToStore(REVIEWS_STORE, review);
            await loadAllReviews();
            await loadProductReviews(currentProduct.id);
            renderProducts();
            showNotif('‚úì Review posted!');
            document.getElementById('reviewName').value = '';
            document.getElementById('reviewRating').value = '5';
            document.getElementById('reviewText').value = '';
        } catch (err) { showNotif('‚úó Error posting review!'); }
    }

    function addToCart(productId) {
        const prod = products.find(p => p.id === productId);
        if (!prod) return;
        
        const existing = cart.find(i => i.id === productId);
        if (existing) {
            existing.qty++;
        } else {
            cart.push({...prod, qty: 1});
        }
        
        updateCartBadge();
        showNotif('‚úì Added to cart!');
    }

    function updateCartBadge() {
        const total = cart.reduce((sum, item) => sum + item.qty, 0);
        document.getElementById('cartBadge').textContent = total;
    }

    function openCart() {
        document.getElementById('cartModal').classList.add('active');
        renderCartItems();
    }

    function closeCart() {
        document.getElementById('cartModal').classList.remove('active');
    }

    function renderCartItems() {
        const container = document.getElementById('cartItemsContainer');
        let subtotal = 0;

        if (cart.length === 0) {
            container.innerHTML = '<div class="cart-empty-msg">Your cart is empty. Add products to continue.</div>';
            document.getElementById('subtotalPrice').textContent = '‚Çπ0';
            document.getElementById('totalPrice').textContent = '‚Çπ0';
            return;
        }

        container.innerHTML = cart.map(item => {
            const lineTotal = item.price * item.qty;
            subtotal += lineTotal;
            return `
                <div class="cart-item">
                    <div class="cart-item-image" style="background-image: url('${item.image}')"></div>
                    <div class="cart-item-details">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-qty">‚Çπ${item.price} each</div>
                        <div style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                            <button class="qty-btn" onclick="updateQty(${item.id}, -1)">‚àí</button>
                            <input type="text" class="qty-input" value="${item.qty}" readonly>
                            <button class="qty-btn" onclick="updateQty(${item.id}, 1)">+</button>
                            <button class="btn-delete" onclick="removeFromCart(${item.id})">Remove</button>
                        </div>
                    </div>
                    <div style="text-align: right; min-width: 60px;">
                        <div class="cart-item-price">‚Çπ${lineTotal}</div>
                    </div>
                </div>
            `;
        }).join('');

        document.getElementById('subtotalPrice').textContent = `‚Çπ${subtotal}`;
        document.getElementById('totalPrice').textContent = `‚Çπ${subtotal}`;
    }

    function updateQty(productId, change) {
        const item = cart.find(i => i.id === productId);
        if (item) {
            item.qty += change;
            if (item.qty <= 0) {
                removeFromCart(productId);
            } else {
                renderCartItems();
                updateCartBadge();
            }
        }
    }

    function removeFromCart(productId) {
        cart = cart.filter(i => i.id !== productId);
        updateCartBadge();
        renderCartItems();
        showNotif('‚úì Removed from cart!');
    }

    function openOrderForm() {
        if (cart.length === 0) { showNotif('‚úó Add products to cart first!'); return; }
        document.getElementById('orderModal').classList.add('active');
        clearOrderForm();
    }

    function closeOrderForm() {
        document.getElementById('orderModal').classList.remove('active');
    }

    function clearOrderForm() {
        document.getElementById('orderName').value = '';
        document.getElementById('orderMobile').value = '';
        document.getElementById('orderEmail').value = '';
        document.getElementById('orderAddress').value = '';
        document.getElementById('orderCity').value = '';
        document.getElementById('orderPincode').value = '';
        document.getElementById('orderState').value = '';
        document.getElementById('orderCountry').value = 'India';
    }

    function submitOrder() {
        const name = document.getElementById('orderName').value.trim();
        const mobile = document.getElementById('orderMobile').value.trim();
        const email = document.getElementById('orderEmail').value.trim();
        const address = document.getElementById('orderAddress').value.trim();
        const city = document.getElementById('orderCity').value.trim();
        const pincode = document.getElementById('orderPincode').value.trim();
        const state = document.getElementById('orderState').value.trim();

        if (!name || !mobile || !address || !city || !pincode || !state) { 
            showNotif('‚úó Please fill all required fields!'); 
            return; 
        }

        if (mobile.length !== 10) { 
            showNotif('‚úó Mobile number must be 10 digits!'); 
            return; 
        }

        let total = 0;
        let orderItems = '';
        
        cart.forEach((item, idx) => {
            const lineTotal = item.price * item.qty;
            total += lineTotal;
            orderItems += `${idx + 1}. ${item.name}%0aQty: ${item.qty} √ó ‚Çπ${item.price} = ‚Çπ${lineTotal}%0a`;
        });

        const message = `*üõçÔ∏è Royal Perfect Order*%0a%0a*üë§ Customer Details:*%0aName: ${name}%0aMobile: ${mobile}%0aEmail: ${email || 'Not provided'}%0a%0a*üìç Delivery Address:*%0a${address}%0a${city}, ${state} - ${pincode}%0a%0a*üì¶ Order Items:*%0a${orderItems}%0a*üí∞ Total Amount: ‚Çπ${total}*%0a%0aThank you for shopping with Royal Perfect!`;

        const whatsappUrl = `https://wa.me/918220390911?text=${message}`;
        window.open(whatsappUrl, '_blank');

        cart = [];
        updateCartBadge();
        clearOrderForm();
        closeOrderForm();
        closeCart();
        showNotif('‚úì Order sent to WhatsApp successfully!');
    }

    function buyNow(productId) {
        addToCart(productId);
        setTimeout(() => openOrderForm(), 300);
    }

    async function addProduct() {
        const name = document.getElementById('newProdName').value.trim();
        const price = parseFloat(document.getElementById('newProdPrice').value);
        const category = document.getElementById('newProdCategory').value;
        const desc = document.getElementById('newProdDesc').value.trim();
        const imageFile = document.getElementById('newProdImage').files[0];

        if (!name || !price || !imageFile) { showNotif('‚úó Fill name, price & select image!'); return; }

        try {
            const image = await convertImageToBase64(imageFile);
            const product = { id: Date.now(), name, price, category, image, desc };
            await saveToStore(PRODUCTS_STORE, product);
            products.push(product);
            renderProducts();
            renderAdminProducts();
            document.getElementById('newProdName').value = '';
            document.getElementById('newProdPrice').value = '';
            document.getElementById('newProdDesc').value = '';
            document.getElementById('newProdImage').value = '';
            document.getElementById('newImagePreview').classList.remove('show');
            showNotif('‚úì Product added!');
        } catch (err) { showNotif('‚úó Error adding product!'); }
    }

    async function renderAdminProducts() {
        const list = document.getElementById('adminProductsList');
        list.innerHTML = products.map(p => `
            <div class="admin-product-item">
                <div class="admin-product-image" style="background-image: url('${p.image}')"></div>
                <div class="admin-product-info">
                    <div class="admin-product-name">${p.name}</div>
                    <div class="admin-product-details">üí∞ ‚Çπ${p.price} | üìÇ ${p.category}</div>
                    <div class="admin-product-details">${p.desc || 'No description'}</div>
                    <div class="admin-product-buttons">
                        <button class="btn-edit" onclick="startEditProduct(${p.id})">‚úèÔ∏è Edit</button>
                        <button class="btn-delete" onclick="deleteProduct(${p.id})">üóëÔ∏è Delete</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    function startEditProduct(id) {
        const product = products.find(p => p.id === id);
        if (!product) return;
        
        editingProductId = id;
        document.getElementById('editProdName').value = product.name;
        document.getElementById('editProdPrice').value = product.price;
        document.getElementById('editProdCategory').value = product.category;
        document.getElementById('editProdDesc').value = product.desc || '';
        document.getElementById('editImagePreview').style.backgroundImage = `url('${product.image}')`;
        document.getElementById('editImagePreview').classList.add('show');
        document.getElementById('editProdImage').value = '';
        
        document.getElementById('editProductModal').classList.add('active');
    }

    async function saveEditProduct() {
        const name = document.getElementById('editProdName').value.trim();
        const price = parseFloat(document.getElementById('editProdPrice').value);
        const category = document.getElementById('editProdCategory').value;
        const desc = document.getElementById('editProdDesc').value.trim();
        const imageFile = document.getElementById('editProdImage').files[0];

        if (!name || !price) { showNotif('‚úó Fill name and price!'); return; }

        try {
            const product = products.find(p => p.id === editingProductId);
            product.name = name;
            product.price = price;
            product.category = category;
            product.desc = desc;

            if (imageFile) {
                product.image = await convertImageToBase64(imageFile);
            }

            await saveToStore(PRODUCTS_STORE, product);
            renderProducts();
            renderAdminProducts();
            closeEditModal();
            showNotif('‚úì Product updated!');
        } catch (err) { showNotif('‚úó Error updating product!'); }
    }

    function closeEditModal() {
        document.getElementById('editProductModal').classList.remove('active');
        editingProductId = null;
    }

    async function deleteProduct(id) {
        if (confirm('Delete this product?')) {
            try {
                await deleteFromStore(PRODUCTS_STORE, id);
                products = products.filter(p => p.id !== id);
                renderProducts();
                renderAdminProducts();
                showNotif('‚úì Product deleted!');
            } catch (err) { showNotif('‚úó Error deleting product!'); }
        }
    }

    async function renderAdminReviews() {
        const list = document.getElementById('adminReviewsList');
        
        if (allReviews.length === 0) {
            list.innerHTML = '<p style="color: var(--text-secondary); text-align: center;">No reviews yet</p>';
            return;
        }

        list.innerHTML = allReviews.map(review => {
            const product = products.find(p => p.id === review.productId);
            return `
                <div class="review-item">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <div style="color: var(--gold); font-weight: 700; font-size: 13px;">${review.name}</div>
                            <div style="color: var(--text-secondary); font-size: 11px;">üì¶ Product: ${product ? product.name : 'Deleted'}</div>
                            <div class="review-stars">${'‚≠ê'.repeat(review.rating)}</div>
                            <div class="review-text" style="margin-top: 8px;">"${review.text}"</div>
                        </div>
                        <button class="btn-delete" onclick="deleteReview(${review.id})">Delete</button>
                    </div>
                </div>
            `;
        }).join('');
    }

    async function deleteReview(id) {
        if (confirm('Delete this review?')) {
            try {
                await deleteFromStore(REVIEWS_STORE, id);
                await loadAllReviews();
                await renderAdminReviews();
                if (currentProduct) await loadProductReviews(currentProduct.id);
                renderProducts();
                showNotif('‚úì Review deleted!');
            } catch (err) { showNotif('‚úó Error deleting review!'); }
        }
    }

    function searchProducts() {
        const query = document.getElementById('searchBox').value.toLowerCase();
        const filtered = products.filter(p => p.name.toLowerCase().includes(query) || p.category.includes(query));
        renderProducts(filtered);
    }

    function filterByCategory(category) {
        clearFilters();
        if (category === 'all') renderProducts(products);
        else renderProducts(products.filter(p => p.category === category));
    }

    function applyFilters() {
        let filtered = [...products];
        const priceRanges = [];
        if (document.getElementById('price1').checked) priceRanges.push([0, 2000]);
        if (document.getElementById('price2').checked) priceRanges.push([2000, 5000]);
        if (document.getElementById('price3').checked) priceRanges.push([5000, 10000]);
        if (document.getElementById('price4').checked) priceRanges.push([10000, Infinity]);
        if (priceRanges.length > 0) filtered = filtered.filter(p => priceRanges.some(range => p.price >= range[0] && p.price <= range[1]));
        renderProducts(filtered);
    }

    function clearFilters() {
        document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
        renderProducts(products);
    }

    function openAdminModal() {
        document.getElementById('adminModal').classList.add('active');
        document.getElementById('adminPasswordSection').style.display = 'block';
        document.getElementById('adminContent').style.display = 'none';
        document.getElementById('adminPass').value = '';
    }

    function closeAdminModal() {
        document.getElementById('adminModal').classList.remove('active');
    }

    function verifyAdmin() {
        const password = document.getElementById('adminPass').value;
        if (password === adminPassword) {
            document.getElementById('adminPasswordSection').style.display = 'none';
            document.getElementById('adminContent').style.display = 'block';
            switchAdminTab('settings');
            renderAdminProducts();
            renderAdminReviews();
            showNotif('‚úì Admin access granted!');
        } else showNotif('‚úó Wrong password!');
    }

    function switchAdminTab(tab) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        
        if (tab === 'settings') {
            document.getElementById('settingsTab').classList.add('active');
            document.querySelectorAll('.tab-btn')[0].classList.add('active');
        } else if (tab === 'products') {
            document.getElementById('productsTab').classList.add('active');
            document.querySelectorAll('.tab-btn')[1].classList.add('active');
            renderAdminProducts();
        } else if (tab === 'reviews') {
            document.getElementById('reviewsTab').classList.add('active');
            document.querySelectorAll('.tab-btn')[2].classList.add('active');
            renderAdminReviews();
        }
    }

    function goHome() { showPage('homePage'); }

    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
    }

    function showNotif(msg) {
        const div = document.createElement('div');
        div.className = 'notification';
        div.textContent = msg;
        document.body.appendChild(div);
        setTimeout(() => div.remove(), 2500);
    }

    document.addEventListener('click', function(event) {
        if (event.target === document.getElementById('cartModal')) closeCart();
        if (event.target === document.getElementById('orderModal')) closeOrderForm();
        if (event.target === document.getElementById('adminModal')) closeAdminModal();
        if (event.target === document.getElementById('editProductModal')) closeEditModal();
    });

    initDB().then(() => {
        loadProducts();
        loadSocialLinks();
    });
</script>

</body>
</html>